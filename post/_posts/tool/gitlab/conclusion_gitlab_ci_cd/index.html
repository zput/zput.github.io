<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>conclusion_gitlab_ci_cd - Zput's blog</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="zput"><meta name=description content="gitlab的总结"><meta name=keywords content="Hugo,theme,even"><meta name=generator content="Hugo 0.101.0 with theme even"><link rel=canonical href=http://localhost:1313/post/_posts/tool/gitlab/conclusion_gitlab_ci_cd/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link href=/sass/main.min.fdb1035139209ff03fa34c28400ff54f04900828b7cafe0d2cfb1f48b70a2ffd.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:title" content="conclusion_gitlab_ci_cd"><meta property="og:description" content="gitlab的总结"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/post/_posts/tool/gitlab/conclusion_gitlab_ci_cd/"><meta property="article:section" content="post"><meta property="article:published_time" content="2020-02-25T21:06:00+00:00"><meta property="article:modified_time" content="2020-02-25T21:06:00+00:00"><meta itemprop=name content="conclusion_gitlab_ci_cd"><meta itemprop=description content="gitlab的总结"><meta itemprop=datePublished content="2020-02-25T21:06:00+00:00"><meta itemprop=dateModified content="2020-02-25T21:06:00+00:00"><meta itemprop=wordCount content="1267"><meta itemprop=keywords content="tool,gitlab,"><meta name=twitter:card content="summary"><meta name=twitter:title content="conclusion_gitlab_ci_cd"><meta name=twitter:description content="gitlab的总结"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>Zput</a></div><div class=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/go-goroutine><li class=mobile-menu-item>go源码专栏</li></a><a href=/post/postgraduate_exam/><li class=mobile-menu-item>软件工程考研专栏</li></a><a href=/post/><li class=mobile-menu-item>时间线</li></a><a href=/categories/><li class=mobile-menu-item>技术类别</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>Zput</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/go-goroutine>go源码专栏</a></li><li class=menu-item><a class=menu-item-link href=/post/postgraduate_exam/>软件工程考研专栏</a></li><li class=menu-item><a class=menu-item-link href=/post/>时间线</a></li><li class=menu-item><a class=menu-item-link href=/categories/>技术类别</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>conclusion_gitlab_ci_cd</h1><div class=post-meta><span class=post-time>2020-02-25</span><div class=post-category><a href=/categories/tools/>tools</a></div></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#大纲>大纲</a><ul><li><a href=#gitlab-pipeline>gitlab pipeline</a><ul><li><a href=#gitlab-runner>GitLab Runner</a></li><li><a href=#gitlab-cicd-variables>gitlab CI/CD Variables</a></li></ul></li><li><a href=#附录>附录</a></li></ul></li></ul></nav></div></div><div class=article-container><div class=post-content><h1 id=大纲>大纲</h1><p><img src=https://raw.githubusercontent.com/zput/myPicLib/master/zput.github.io/gitlab.png alt=gitlab></p><h2 id=gitlab-pipeline>gitlab pipeline</h2><p><img src=https://raw.githubusercontent.com/zput/myPicLib/master/zput.github.io/20210105154153.png alt="gitlab illustration"></p><ul><li>gitlab&rsquo;s pipeline一体两面<ul><li>pipeline定义在项目的 .gitlab-ci.yml里, 由stages串联组成。（每个stages里面并行多个job）</li><li>外在表现就为：<img src=https://raw.githubusercontent.com/zput/myPicLib/master/zput.github.io/20210105144424.png alt=pipeline></li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>alpine:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>stages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>deploy </span><span class=w> </span><span class=c># dummy stage to follow the template guidelines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>staging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>production</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>.build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;xxxx/auto-build-image:latest&#34;</span><span class=w> </span><span class=c># in order to connect docker:dind, this base image should install docker.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>build</span><span class=w> </span><span class=c># this points out which stage.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>before_script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>.auto-deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;xxxx/auto-deploy-image:latest&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>deploy</span><span class=w> </span><span class=c># this points out which stage.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>auto-deploy download</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>auto-deploy update</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>auto-deploy upgrade</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tags</span><span class=p>:</span><span class=w>   </span><span class=c># this points out which gitlab-runner.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>environment</span><span class=p>:</span><span class=w> </span><span class=c># deploy to kubernets.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>develop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>kubernetes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>develop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>docker(api)</span><span class=p>:</span><span class=w>  </span><span class=c># name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=l>.build</span><span class=w> </span><span class=c># directly reference above .build.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>SERVICE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;api&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>refs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>develop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/^release_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/^hotfix_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>changes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>api/**/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>develop</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=l>.auto-deploy</span><span class=w> </span><span class=c># directly reference above .auto-deploy.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=l>.auto-deploy</span><span class=w> </span><span class=c># directly reference above .auto-deploy.</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=gitlab-runner>GitLab Runner</h3><p><img src=https://raw.githubusercontent.com/zput/myPicLib/master/zput.github.io/20210105202933.png alt=20210105202933></p><p>有了.gitlab-ci.yaml, 需要执行pipeline的地方，这个就是gitlab-runner.
在这里使用的是<a href=https://zput.github.io/2020/01/22/tool/gitlab/the_process_structure_ci_cd_base_on_gitlab/#helm%E5%AE%89%E8%A3%85>helm安装方法</a></p><h4 id=should-install-docker-in-base-container>should install docker in base container</h4><p>应该要安装docker client，才能与docker daemon进行交流。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>.build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>docker:20.10.1</span><span class=w> </span><span class=c># in order to connect docker:dind, this base image should install docker.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#image: &#34;xxx/auto-build-image:v0.0.0.7&#34; # in order to connect docker:dind, this base image should install docker.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>docker:19.03.14-dind</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>alias</span><span class=p>:</span><span class=w> </span><span class=l>docker</span><span class=w> </span><span class=c># alias</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>验证结果如下：
<img src=https://raw.githubusercontent.com/zput/myPicLib/master/zput.github.io/20210105202813.png alt=20210105202813></p><h4 id=alias>alias</h4><p>这里重点提一下：从上面的图中可以知道baseImage可以连接Services,</p><ul><li><code># The 'docker' hostname is the alias of the service container as described at</code></li></ul><p>所以,这里需要给Servers起一个别名：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>.build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>docker:20.10.1</span><span class=w> </span><span class=c># in order to connect docker:dind, this base image should install docker.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#image: &#34;xxx/auto-build-image:v0.0.0.7&#34; # in order to connect docker:dind, this base image should install docker.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>docker:19.03.14-dind</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>alias</span><span class=p>:</span><span class=w> </span><span class=l>docker</span><span class=w> </span><span class=c># alias</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>下面是专门只改了services中的版本号，可以发现Engine的确是改变了。
<img src=https://raw.githubusercontent.com/zput/myPicLib/master/zput.github.io/20210105201014.png alt=20210105201014></p><h3 id=gitlab-cicd-variables>gitlab CI/CD Variables</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ACCESS_TOKEN_PWD
</span></span><span class=line><span class=cl>ACCESS_TOKEN_USR
</span></span><span class=line><span class=cl>API_ADMIN_VAR_URL
</span></span><span class=line><span class=cl>CHART_REPOSITORY
</span></span><span class=line><span class=cl>CHART_REPOSITORY_PASSWORD
</span></span><span class=line><span class=cl>CHART_REPOSITORY_USER
</span></span><span class=line><span class=cl>CI_REGISTRY
</span></span><span class=line><span class=cl>CI_REGISTRY_PASSWORD
</span></span><span class=line><span class=cl>CI_REGISTRY_USER
</span></span><span class=line><span class=cl>develop_codesprite_helm_chart_values_yaml
</span></span><span class=line><span class=cl>develop_micro_api
</span></span><span class=line><span class=cl>develop_micro_core
</span></span><span class=line><span class=cl>develop_micro_grpcgw
</span></span><span class=line><span class=cl>develop_micro_pbgw
</span></span><span class=line><span class=cl>develop_micro_worker
</span></span><span class=line><span class=cl>develop_web_admin
</span></span><span class=line><span class=cl>develop_web_ai
</span></span><span class=line><span class=cl>develop_web_wechat
</span></span><span class=line><span class=cl>PRIVATE_TOKEN
</span></span></code></pre></td></tr></table></div></div><h2 id=附录>附录</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>alpine:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># When using dind service, we need to instruct docker to talk with</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># the daemon started inside of the service. The daemon is available</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># with a network connection instead of the default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># /var/run/docker.sock socket.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>DOCKER_HOST</span><span class=p>:</span><span class=w> </span><span class=l>tcp://docker:2376</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># The &#39;docker&#39; hostname is the alias of the service container as described at</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#accessing-the-services.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># If you&#39;re using GitLab Runner 12.7 or earlier with the Kubernetes executor and Kubernetes 1.6 or earlier,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># the variable must be set to tcp://localhost:2376 because of how the</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Kubernetes executor connects services to the job container</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># DOCKER_HOST: tcp://localhost:2376</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Specify to Docker where to create the certificates, Docker will</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># create them automatically on boot, and will create</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># `/certs/client` that will be shared between the service and job</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># container, thanks to volume mount from config.toml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>DOCKER_TLS_CERTDIR</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/certs&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># These are usually specified by the entrypoint, however the</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Kubernetes executor doesn&#39;t run entrypoints</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># https://gitlab.com/gitlab-org/gitlab-runner/-/issues/4125</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>DOCKER_TLS_VERIFY</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>DOCKER_CERT_PATH</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;$DOCKER_TLS_CERTDIR/client&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>stages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>deploy </span><span class=w> </span><span class=c># dummy stage to follow the template guidelines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>dast</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>staging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>canary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>production</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>cleanup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>.auto-deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;xxx/auto-deploy-image:latest&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>auto-deploy download</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>auto-deploy update</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>auto-deploy upgrade</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tags</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>develop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>kubernetes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>develop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>.build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;xxx/auto-build-image:latest&#34;</span><span class=w>  </span><span class=c># in order to connect docker:dind, this base image should install docker.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>docker:19.03.14-dind</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>alias</span><span class=p>:</span><span class=w> </span><span class=l>docker</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>before_script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;$CI_REGISTRY_PASSWORD&#34; | docker login -u &#34;$CI_REGISTRY_USER&#34; &#34;$CI_REGISTRY&#34; --password-stdin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>docker version</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>CI_IMAGE=&#34;${CI_REGISTRY}/codesprite/${SERVICE}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>VER=&#34;`cat .version`.${CI_PIPELINE_ID}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>docker build -t &#34;${CI_IMAGE}:${VER}&#34; -t &#34;${CI_IMAGE}:latest&#34; --build-arg ACCESS_TOKEN_USR --build-arg ACCESS_TOKEN_PWD --build-arg SERVICE=${SERVICE} .</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>docker push &#34;${CI_IMAGE}:${VER}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>docker push &#34;${CI_IMAGE}:latest&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>      #set image version to gitlab instance variables
</span></span></span><span class=line><span class=cl><span class=sd>      var_name_self=${ACCESS_TOKEN_USR}___${ACCESS_TOKEN_PWD}
</span></span></span><span class=line><span class=cl><span class=sd>      echo &#34;`cat ${var_name_self}`---&#34;
</span></span></span><span class=line><span class=cl><span class=sd>      prefix=${CI_COMMIT_REF_NAME//_*/}
</span></span></span><span class=line><span class=cl><span class=sd>      var_name=${prefix}_micro_${SERVICE}
</span></span></span><span class=line><span class=cl><span class=sd>      echo &#34;var name is ${var_name}&#34;
</span></span></span><span class=line><span class=cl><span class=sd>      remote_ver=$(curl -s --header &#34;PRIVATE-TOKEN: ${PRIVATE_TOKEN}&#34; &#34;${API_ADMIN_VAR_URL}/${var_name}&#34; | jq -r &#39;.value&#39;)
</span></span></span><span class=line><span class=cl><span class=sd>      echo &#34;${var_name} saved value is ${remote_ver}&#34;
</span></span></span><span class=line><span class=cl><span class=sd>      if [[ ${remote_ver} == null ]]; then
</span></span></span><span class=line><span class=cl><span class=sd>        echo &#34;create var ${var_name}, init value is ${VER}&#34;
</span></span></span><span class=line><span class=cl><span class=sd>        curl -s --request POST --header &#34;PRIVATE-TOKEN: ${PRIVATE_TOKEN}&#34; &#34;${API_ADMIN_VAR_URL}&#34; --form &#34;key=${var_name}&#34; --form &#34;value=${VER}&#34; | jq
</span></span></span><span class=line><span class=cl><span class=sd>      else
</span></span></span><span class=line><span class=cl><span class=sd>        echo &#34;update var ${var_name} to ${VER}&#34;
</span></span></span><span class=line><span class=cl><span class=sd>        curl -s --request PUT --header &#34;PRIVATE-TOKEN: ${PRIVATE_TOKEN}&#34; &#34;${API_ADMIN_VAR_URL}/${var_name}&#34; --form &#34;value=${VER}&#34; | jq 
</span></span></span><span class=line><span class=cl><span class=sd>      fi</span><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>docker(api)</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=l>.build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>SERVICE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;api&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>refs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>develop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/^release_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/^hotfix_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>changes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>api/**/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>develop</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=l>.auto-deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>refs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>develop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>changes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>pbgw/**/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>core/**/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>api/**/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>worker/**/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>grpcgw/**/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>production</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=l>.auto-deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>/^release_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>docker(worker)</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=l>.build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>SERVICE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;worker&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>refs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>develop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>/^release_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>/^hotfix_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>changes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>worker/**/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>docker(core)</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=l>.build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>SERVICE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;core&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>refs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>develop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>/^release_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>/^hotfix_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>changes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>core/**/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>docker(pbgw)</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=l>.build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>SERVICE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;pbgw&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>refs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>develop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>/^release_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>/^hotfix_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>changes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>pbgw/**/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>docker(grpcgw)</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=l>.build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>SERVICE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;grpcgw&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>refs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>develop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>/^release_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>/^hotfix_.*$/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>changes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>grpcgw/**/*</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></div></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>zput</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2020-02-25</span></p></div><footer class=post-footer><div class=post-tags><a href=/tags/tool/>tool</a>
<a href=/tags/gitlab/>gitlab</a></div><nav class=post-nav><a class=prev href=/post/_posts/tool/kafka/><i class="iconfont icon-left"></i>
<span class="prev-text nav-default">kafka总结</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=/post/_posts/tool/mysql/><span class="next-text nav-default">mysql高级总结</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><script src=https://utteranc.es/client.js repo=zput/utterances-comments issue-term=pathname theme=github-light crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:wkzxc@sina.com class="iconfont icon-email" title=email></a>
<a href=https://github.com/zput class="iconfont icon-github" title=github></a>
<a href=http://localhost:1313/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=copyright-year>&copy;
2017 -
2022<span class=heart><i class="iconfont icon-heart"></i></span><span>zput</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js></script>
<script type=text/javascript>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin=anonymous></script></body></html>